<!DOCTYPE html>
<html class="nojs" lang="en-us" dir="ltr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>arcpy – Node Dangles</title>
<link rel="alternate" type="application/rss+xml" title="RSS" href="https://maprantala.com/tags/arcpy/index.xml">
<meta name="description" content="">
<meta name="created" content="2018-05-08T17:56:09-0500">
<meta name="modified" content="2018-05-08T17:56:09-0500">
<meta name="author" content="Matthew Rantala">

<meta property="og:site_name" content="Node Dangles">
<meta property="og:title" content="arcpy">
<meta property="og:url" content="https://maprantala.com/tags/arcpy/">
<meta property="og:type" content="website">

<meta name="generator" content="Hugo 0.80.0" />
<meta name="msapplication-TileColor" content="#ffffff">
<meta name="theme-color" content="#ffffff">


<link rel="canonical" href="https://maprantala.com/tags/arcpy/">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">

<link rel="stylesheet" href="/css/styles.159e5347492c734a666a2678db9a478c339b9ad376372e062cd19572540448a1.css">
<link rel="stylesheet" href="/css/print.27fc184f8670f41a2690985390779e7b20335a8fadff8fa015cf9417ffe50c36.css" media="print">

<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebPage",
    "url" : "https://maprantala.com/tags/arcpy/",
    "name": "arcpy",
    "description": "Geospatial Programming Blog",
    "author": {
      "@type": "Person",
      "name": "Matthew Rantala"
    },
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://maprantala.com"
    },
    "publisher": {
      "@type": "Organization",
      "name": "Node Dangles",
      "url": "https://maprantala.com"
    }
  }
</script>

<script src="/js/script-early.min.a8d899ac88f2a778985767b86ce681945e3fa2069c3c9efd17e5e5b594d3ba1f.js"></script>
<script defer src="/js/lib/umbrella.min.e2bb46ea729a2df1793c868bff01df1f4a4889a5c8c97a2f176aebb9c514b3e6.js"></script>
<script defer src="/js/script.min.f7f56769569fdf7a80d073b6775c6cd9ed8ae528864cd3f2aa1c8c3fe73f87ea.js"></script>


</head>

<body class="list-page">
<div class="page layout__page layout__sidebar-second">
<header class="header layout__header">
<a href="/" title="Home" rel="home" class="header__logo"><img src="/images/logo.png" alt="Home" class="header__logo-image"></a>
<h1 class="header__site-name">
<a href="/" title="Home" class="header__site-link" rel="home"><span>Node Dangles</span></a>
</h1>
<div class="region header__region">
</div>
</header>

<nav class="main-menu layout__navigation">
<h2 class="visually-hidden">Main menu</h2>
<ul class="navbar">
<li><a href="/" class="active" aria-current="page">Home</a></li>
<li><a href="/posts/">Posts</a></li>
</ul>
</nav>


<main class="main layout__main">
<h1 class="title">arcpy</h1>
<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2018/05/08/using-arcpy.mapping-to-update-definition-queries./">Using ArcPy.Mapping to update Definition Queries.</a></h2>

</header>
<div class="content">
Working with a routine process today that I normally only do once in awhile but today needed to do it several times. It requires changing the definition query on several features classes. Being the &lsquo;lazy&rsquo; GIS guy that I am (owner of a company I used to work at called me that once as a sort of compliment for my tendency to script a lot of what I did), I decided to finally script it instead of changing definition queries about 42 times.
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2017/10/04/arctoolbox-tool-add-st_con_abr-to-hennepin-county-mn-centerlines/">ArcToolbox Tool: Add [ST_CON_ABR] to Hennepin County, MN Centerlines</a></h2>

</header>
<div class="content">
One of the great advancements over the last decade plus in GIS is that government agencies have started to move away from a &lsquo;recover-our-cost&rsquo; mentality to more of an &lsquo;Open Data&rsquo;. Minnesota, for example, has launched their Geospatial Commonsas a platform for sharing data.
And while getting free, authoritative data is awesome, it can leave you in a bind if the structure of the data changes. Sometime between April and September, Hennepin County, Minnesota, changed the schema of their publicly available street centerlines data.
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2015/08/14/converting-mxd-to-layer-file-in-arcpy/">Converting MXD to Layer file in Arcpy</a></h2>

</header>
<div class="content">
Working on doing some advanced ArcGIS server printingand had the need to batch convert many existing .mxd files to .lyr files. So instead of opening up X number of map documents, thought I would do it via code. All of my .mxds in this case had just one data frame so the process was pretty simple–I add an empty group layer (Thanks Petr Krebsfor the idea), copy all the existing layers into it, and save it out as a layer file.
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2014/12/31/calling-os.startfile-and-webbrowser.open-from-arcgis./">Calling os.startfile and webbrowser.open from ArcGIS.</a></h2>

</header>
<div class="content">
Recently I&rsquo;ve created Python add-insfor data entry for our staff. Most of these have a toolbar with a &lsquo;Help&rsquo; button that opens a help file in .pdf format.Sample python add-in toolbar.The first add-in was for ArcCatalog and this worked splendidly. I was using os.startfile(path to help.pdf).
However, when I started doing ArcMap add-ins, clicking the Help button would open the help.pdf but ArcMap would crash. Oops!
Luckily the Python development team at Esrialready had a blog postabout this at their ArcPy Café blog.
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2014/12/03/quick-#038-dirty-arcpy-listing-data-sources/">Quick &amp;#038; Dirty ArcPy: Listing Data Sources</a></h2>

</header>
<div class="content">
I just had the need to go through a directory containing many (100+) layer files (.lyr) and verify the data sources in each. I could have loaded each into ArcMap and checked the properties, but choose not to. Here&rsquo;s the bare-bones script I used instead:
  
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2014/05/16/garmin-gpx-to-shapefile-shp-conversion-gpx2shp.py/">Garmin GPX to Shapefile (SHP) conversion GPX2Shp.py</a></h2>

</header>
<div class="content">
I mentioned using Tapiriikto batch download my entire Garmin Connect history–over 1,000 separate .GPX files. I found several tools to convert .GPX to shapefilesthat worked but none seemed to recognize my heart rate data.
The trick is Garmin extends the GPX specification to incorporate the heart rate:
Each track point looks like this:
 Since the first few exiting GPX converters failed to meet my needs, I decided to make my own, at least partially.
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2014/04/02/arcpy.listfeatureclasses-bug/">arcpy.ListFeatureClasses() Bug</a></h2>

</header>
<div class="content">
I was recently re-evaluating our back-up procedures and discovered and found a nasty bug with the arcpy&rsquo;s ListFeatureClassesrequest. If you have a feature class in a feature dataset with the same name, ListFeatureClasses may not find it or anything else in that feature dataset.
Unfortunately, we recently made our daily backup a python-based system that uses ListFeatureClasses and got bit by this bug.
After discovering missing data in our backups, I reconstructed what happened and found this bug.
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2013/09/23/arcpy-check-if-a-field-exists/">Arcpy: Check if a field exists</a></h2>

</header>
<div class="content">
I was helping a co-worker who needed to check if a field exists in their arcpy script. Since we were located at their computer, I thought I would just do a quick Google search and pull the code off this blog. Seemed logical since I the original purpose was exactly that—to serve as a handy, public place to store code snippets that I use &amp; that others might find handy.
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2013/09/05/arcmap-field-calculator-number-of-parts-in-multi-part-feature/">ArcMap Field Calculator: Number of parts in multi-part feature</a></h2>

</header>
<div class="content">
In the last week, I have looked for multi-part features a couple of times. Today, I was looking for multi-part polygons after dealing with the fall-out of a case of Clip Gone Wild as shown below.

I have not found a way to write a query to find these but Field Calculator does allow you to calculate a field’s value to the number of parts.
Using the Python parser, just write the formula (note that case matters): !
</div>
</article>

<article class="section-posts list-view">
<header>
<h2 class="title "><a href="/2012/05/31/quick-#038-dirty-python-converting-a-text-file-to-audio-.wav/">Quick &amp;#038; Dirty python: Converting a text file to audio (.wav)</a></h2>

</header>
<div class="content">
This is a bit of a tangent but for some crazy reason, I wanted to convert some text to audio so I could listen to it while I drive. A quick Google search left me without any freeware that could handle the 53 page document–there are some cool websites that do text to mp3 like vozme and YAKiToMe! but they didn&rsquo;t convert the whole document. I then found pyTTS, a python package that serves as a wrapper to the Microsoft Speech API (SAPI) , which has been in version 5 since 2000.
</div>
</article>

<nav class="pager">
<a href="/tags/arcpy/page/2/" rel="next" class="pager-item pager-next">Next</a>
</nav>

</main>


<footer class="footer layout__footer">
<p><span>© Node Dangles</span></p>


</footer>

</div>
</body>
</html>
